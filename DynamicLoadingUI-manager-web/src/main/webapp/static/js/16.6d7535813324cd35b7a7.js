webpackJsonp([16],{HzJ8:function(t,s,e){t.exports={default:e("aSM5"),__esModule:!0}},aSM5:function(t,s,e){e("dmd9"),e("wCtA"),t.exports=e("rLQK")},gKRT:function(t,s,e){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var i=e("3cXf"),r=e.n(i),o=e("HzJ8"),a=e.n(o),n={data:function(){return{itemList:[{text:"存入礼物包",id:1},{text:"实物发货",id:0}],showOrderType:!1,orderType:1,orderList:[],shopPrices:[],couponPrices:[],inputs:[],payment:0,confirmAddress:""}},watch:{},components:{BottomPopup:e("VO0z").a},computed:{getMobile:function(){if(this.confirmAddress){var t=this.confirmAddress.mobile.toString();return t.substring(0,3)+"****"+t.substring(7,11)}},totalPrices:function(){var t=0,s=!0,e=!1,i=void 0;try{for(var r,o=a()(this.shopPrices);!(s=(r=o.next()).done);s=!0){t+=r.value}}catch(t){e=!0,i=t}finally{try{!s&&o.return&&o.return()}finally{if(e)throw i}}return t},totalCoupon:function(){var t=0,s=!0,e=!1,i=void 0;try{for(var r,o=a()(this.couponPrices);!(s=(r=o.next()).done);s=!0){t+=r.value}}catch(t){e=!0,i=t}finally{try{!s&&o.return&&o.return()}finally{if(e)throw i}}return t}},created:function(){this.initOrderType(),this.initOrderList(),this.initAddress(),this.initInput()},methods:{showOT:function(){this.showOrderType=!0},initOrderList:function(){var t=this,s=localStorage.getItem("orderList"),e=JSON.parse(s);this.orderList=e,e.forEach(function(s){var e=0;s.cartInfos.forEach(function(t){e+=t.buyNum*t.discountPrice}),t.shopPrices.push(e)})},initOrderType:function(){if(localStorage.getItem("orderType")){var t=localStorage.getItem("orderType");this.orderType=parseInt(t)}},initAddress:function(){var t=this;if(localStorage.getItem("confirmAddress")){var s=JSON.parse(localStorage.getItem("confirmAddress"));this.confirmAddress=s}else this.$Api.getShippingAddressList().then(function(s){if(console.log(s),0==s.q.s&&s.q.total>0){s.q.addresses.forEach(function(s){1==s.selected&&(console.log(s),t.confirmAddress=s)})}})},initInput:function(){localStorage.getItem("inputs")&&(this.inputs=JSON.parse(localStorage.getItem("inputs")))},setInputValue:function(){var t=this,s=this.$refs.input;this.inputs=[],s.forEach(function(s){t.inputs.push(s.value)});var e=r()(this.inputs);localStorage.setItem("inputs",e)},clearStorage:function(){localStorage.removeItem("orderType"),localStorage.removeItem("orderList"),localStorage.removeItem("confirmAddress"),localStorage.removeItem("inputs")},getBottomPopup:function(t){localStorage.removeItem("orderType"),"cancel"!=t&&(this.orderTypeText=t.text,this.orderType=t.id,localStorage.setItem("orderType",t.id)),this.showOrderType=!1},getOrderSubmit:function(){var t=this,s=[];this.orderList.forEach(function(e,i){var r=[],o={};o.orgId=e.orgId,o.note=t.inputs[i],o.coupons="",e.cartInfos.forEach(function(t,s){var e={};e.skuId=t.skuId,e.spuId=t.spuId,e.num=t.buyNum,e.promId=t.promId,e.customId=t.customId,r.push(e)}),o.goodsList=r,s.push(o)}),console.log(s);var e={a:1,t:1,sendType:this.orderType,addresId:this.confirmAddress.id,shops:s};console.log(e),this.$Api.getOrderSubmit(e).then(function(t){})},linkToCashier:function(){this.getOrderSubmit(),this.setInputValue()}}},c={render:function(){var t=this,s=t.$createElement,i=t._self._c||s;return i("div",{attrs:{id:"confirm-order"}},[i("common-header",{attrs:{title:"确认订单"}}),t._v(" "),i("div",{staticClass:"cell bg-fff",on:{click:t.showOT}},[t._v("\n      送礼类型\n      "),i("span",{directives:[{name:"show",rawName:"v-show",value:1===t.orderType,expression:"orderType===1"}],staticClass:"fl-right"},[t._v("存入礼物包")]),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:0===t.orderType,expression:"orderType===0"}],staticClass:"fl-right"},[t._v("实物发货")]),t._v(" "),i("img",{staticClass:"arrow_gray",attrs:{src:e("R8dh")}})]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:0===t.orderType,expression:"orderType===0"}],staticClass:"order-address bg-fff",on:{click:function(s){t.linkTo("ConfirmAddress")}}},[i("div",{staticClass:"address-info"},[t.confirmAddress?[i("div",{staticClass:"name-phone clearfix"},[i("span",{staticClass:"fl-left"},[t._v("收货人："+t._s(t.confirmAddress.name))]),t._v(" "),i("span",{staticClass:"fl-right"},[t._v(t._s(t.getMobile))])]),t._v(" "),i("div",{staticClass:"address-detail"},[t._v("\n\t          "+t._s(t.confirmAddress.street)+"\n\t        ")]),t._v(" "),i("img",{staticClass:"arrow_gray",attrs:{src:e("R8dh")}})]:[t._v("未选择")]],2),t._v(" "),i("img",{staticClass:"address-bor",attrs:{src:e("9JnP")}})]),t._v(" "),i("div",{staticClass:"order-detail"},t._l(t.orderList,function(s,r){return i("div",{staticClass:"detail-shop bg-fff"},[i("div",{staticClass:"cell text-over"},[t._v(t._s(s.orgName))]),t._v(" "),i("div",{staticClass:"good-list"},[t._l(s.cartInfos,function(s,e){return i("div",{staticClass:"list-item"},[i("div",{staticClass:"item-img fl-left"},[i("img",{attrs:{src:s.imagePath,alt:""}})]),t._v(" "),i("div",{staticClass:"item-info fl-left"},[i("div",{staticClass:"title"},[t._v(t._s(s.name))]),t._v(" "),i("div",[t._v(t._s(s.productSize))]),t._v(" "),i("div",{staticClass:"goods-prices"},[i("span",{staticClass:"price"},[i("em",{staticStyle:{"font-size":"0.32rem"}},[t._v("￥")]),t._v(t._s(s.discountPrice))]),t._v(" "),i("span",{staticClass:"item-count fl-right"},[t._v("x"+t._s(s.buyNum))])])])])}),t._v(" "),i("div",{staticClass:"cell bg-fff",on:{click:function(s){t.linkTo("ConfirmCoupon")}}},[i("span",[t._v("优惠券")]),t._v(" "),i("span",{staticClass:"span-tag"},[t._v("0张可用")]),t._v(" "),i("span",{staticClass:"fl-right"},[t._v("未选择")]),t._v(" "),i("img",{staticClass:"arrow_gray",attrs:{src:e("R8dh")}})]),t._v(" "),i("div",{staticClass:"cell bg-fff"},[t._v("\n            买家留言\n            "),i("input",{ref:"input",refInFor:!0,staticClass:"order-msg fl-right",attrs:{type:"text",placeholder:"选填"},domProps:{value:t.inputs[r]},on:{input:t.setInputValue}})]),t._v(" "),i("div",{staticClass:"cell bg-fff",staticStyle:{border:"none"}},[i("span",{staticClass:"fl-right",staticStyle:{"margin-right":"0"}},[t._v("合计： "),i("em",{staticStyle:{color:"#fe4436"}},[t._v("￥"+t._s(t.shopPrices[r]))])])])],2)])})),t._v(" "),i("div",{staticClass:"detail-shop order-price bg-fff"},[i("div",{staticStyle:{"margin-bottom":"0.32rem"}},[t._v("总金额"),i("span",{staticClass:"fl-right",staticStyle:{color:"#fe4436"}},[t._v(" ￥"+t._s(t.totalPrices))])]),t._v(" "),i("div",[t._v("优惠券"),i("span",{staticClass:"fl-right",staticStyle:{color:"#fe4436"}},[t._v(" -￥"+t._s(t.totalCoupon))])])]),t._v(" "),i("div",{staticClass:"footer"},[i("div",{staticClass:"fl-right"},[i("span",{staticClass:"total-price"},[t._v("实付款：")]),t._v(" "),i("span",{staticClass:"price"},[t._v("￥"+t._s(t.totalPrices-t.totalCoupon))]),t._v(" "),i("span",{staticClass:"goods-account",on:{click:t.linkToCashier}},[t._v("提交订单")])])]),t._v(" "),t.showOrderType?i("div",{staticClass:"shadow"},[i("BottomPopup",{attrs:{itemList:t.itemList},on:{selItem:t.getBottomPopup}})],1):t._e()],1)},staticRenderFns:[]},l=e("OF7X")(n,c,!1,function(t){e("uEOI")},null,null);s.default=l.exports},rLQK:function(t,s,e){var i=e("Dc6E"),r=e("X6b2");t.exports=e("UusJ").getIterator=function(t){var s=r(t);if("function"!=typeof s)throw TypeError(t+" is not iterable!");return i(s.call(t))}},uEOI:function(t,s){}});
//# sourceMappingURL=16.6d7535813324cd35b7a7.js.map