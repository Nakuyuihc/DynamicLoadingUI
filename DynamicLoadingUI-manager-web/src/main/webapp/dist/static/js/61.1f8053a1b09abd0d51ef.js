webpackJsonp([61],{RRku:function(t,s){},YrOL:function(t,s,i){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var e={data:function(){return{starIndex:-1,title:"发表评价",textValue:"",imgList:[],fileList:[],urlList:[],upLoadUrlList:[],imgIdList:[]}},components:{CommonHeader:i("i2Wk").a},computed:{isComplete:function(){return this.textValue.length>0&&-1!=this.starIndex}},methods:{selectStar:function(t){this.starIndex=t},uploadImg:function(){var t=this,s=document.getElementById("publish-img").files[0],i=s.name;this.fileList.push(s),this.oFile=s,this.filename=i;var e={a:1,type:1,filename:i,oFile:s};this.getExternalUploadObject(e);var a=new FileReader;a.readAsDataURL(s),a.onload=function(i){var e=i.currentTarget.result;t.imgList.push(e),s.value="",document.getElementById("publish-img").value=""}},delImg:function(t,s){this.imgList.splice(s,1),this.urlList.splice(s,1),this.fileList.splice(s,1)},getExternalUploadObject:function(t){var s=this;this.$Api.getExternalUploadObject(t).then(function(t){if(console.log(t),0==t.q.s){s.cos=t.q.cos;var i={accessUrl:t.q.cos.accessUrl,sourceUrl:t.q.cos.sourceUrl};console.log(i),s.urlList.push(i),s.upLoadUrlList.push(t.q.cos.url)}})},getExternalFilesSubmit:function(){var t=this,s=this,i=[];this.urlList.forEach(function(t){var s={accessUrl:t.accessUrl,sourceUrl:t.sourceUrl};i.push(s)}),console.log(i),this.$Api.getExternalFilesSubmit(1,1,i).then(function(i){if(console.log(i),0==i.q.s){i.q.files.forEach(function(s){console.log(s.id),t.imgIdList.push(s.id)});for(var e=0;e<t.fileList.length;e++)s.$upLoadToCos(t.upLoadUrlList[e],t.fileList[e]);t.getCommentSubmit()}})},commentSubmit:function(){this.isComplete&&this.getExternalFilesSubmit()},getCommentSubmit:function(){var t=this.$route.params.id,s=[],i={userId:0,starNum:this.starIndex,content:this.textValue,imageIds:this.imgIdList};s.push(i),this.$Api.CommentSubmit(11,t,s).then(function(t){console.log(t)})}}},a={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{attrs:{id:"publish"}},[e("common-header",{attrs:{title:t.title}}),t._v(" "),e("div",{staticClass:"publish-content"},[e("div",{staticClass:"publish-text"},[e("img",{staticClass:"goods-img",attrs:{src:i("o3Ya")}}),t._v(" "),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.textValue,expression:"textValue"}],attrs:{placeholder:"礼物怎么样？说说您的看法吧~"},domProps:{value:t.textValue},on:{input:function(s){s.target.composing||(t.textValue=s.target.value)}}})]),t._v(" "),e("div",{staticClass:"publish-imgs clearfix"},[e("ul",{staticClass:"clearfix"},[t._l(t.imgList,function(s,a){return e("li",[e("img",{staticClass:"publish-icon",attrs:{src:s}}),t._v(" "),e("div",{staticClass:"del-btn",on:{click:function(i){t.delImg(s,a)}}},[e("img",{attrs:{src:i("Xmmv")}})])])}),t._v(" "),e("li",{directives:[{name:"show",rawName:"v-show",value:t.imgList.length<6,expression:"imgList.length<6"}]},[e("img",{staticClass:"publish-icon",attrs:{src:i("rGQL")}}),t._v(" "),e("input",{ref:"imgInput",attrs:{type:"file",accept:"image/*",name:"file[]",id:"publish-img"},on:{change:function(s){t.uploadImg(s)}}})])],2)])]),t._v(" "),e("div",{staticClass:"publish-score"},[e("span",[t._v("评分")]),t._v(" "),e("span",[e("i",{staticClass:"star",class:{active:t.starIndex>=1},on:{click:function(s){t.selectStar(1)}}}),t._v(" "),e("i",{staticClass:"star",class:{active:t.starIndex>=2},on:{click:function(s){t.selectStar(2)}}}),t._v(" "),e("i",{staticClass:"star",class:{active:t.starIndex>=3},on:{click:function(s){t.selectStar(3)}}}),t._v(" "),e("i",{staticClass:"star",class:{active:t.starIndex>=4},on:{click:function(s){t.selectStar(4)}}}),t._v(" "),e("i",{staticClass:"star",class:{active:t.starIndex>=5},on:{click:function(s){t.selectStar(5)}}})])]),t._v(" "),e("div",{staticClass:"publish-btn",class:{active:t.isComplete},on:{click:t.commentSubmit}},[t._v("发表评价")])],1)},staticRenderFns:[]},l=i("VU/8")(e,a,!1,function(t){i("RRku")},null,null);s.default=l.exports}});
//# sourceMappingURL=61.1f8053a1b09abd0d51ef.js.map